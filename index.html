<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Pendaftaran Siswa Baru</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        background: linear-gradient(
          135deg,
          #0891b2 0%,
          #06b6d4 50%,
          #10b981 100%
        );
        min-height: 100vh;
        padding: 20px;
      }

      .container {
        max-width: 900px;
        margin: 0 auto;
        background: white;
        border-radius: 24px;
        box-shadow: 0 25px 70px rgba(0, 0, 0, 0.2);
        overflow: hidden;
      }

      .header {
        background: linear-gradient(
          135deg,
          #0284c7 0%,
          #0891b2 50%,
          #059669 100%
        );
        color: white;
        padding: 50px 40px;
        text-align: center;
        position: relative;
        overflow: hidden;
      }

      .header::before {
        content: "";
        position: absolute;
        top: -50%;
        right: -50%;
        width: 200%;
        height: 200%;
        background: radial-gradient(
          circle,
          rgba(255, 255, 255, 0.1) 0%,
          transparent 70%
        );
        animation: float 15s infinite ease-in-out;
      }

      @keyframes float {
        0%,
        100% {
          transform: translate(0, 0) rotate(0deg);
        }
        50% {
          transform: translate(-20px, -20px) rotate(180deg);
        }
      }

      .header .organization {
        font-size: 16px;
        font-weight: 600;
        margin-bottom: 8px;
        letter-spacing: 1px;
        position: relative;
        z-index: 1;
        text-transform: uppercase;
        opacity: 0.95;
      }

      .header .school-name {
        font-size: 26px;
        font-weight: 700;
        margin-bottom: 30px;
        letter-spacing: 0.5px;
        position: relative;
        z-index: 1;
      }

      .header h1 {
        font-size: 32px;
        margin-bottom: 12px;
        font-weight: 700;
        position: relative;
        z-index: 1;
      }

      .header .academic-year {
        font-size: 22px;
        font-weight: 600;
        opacity: 0.95;
        position: relative;
        z-index: 1;
        background: rgba(255, 255, 255, 0.15);
        display: inline-block;
        padding: 8px 24px;
        border-radius: 20px;
        margin-top: 10px;
      }

      .form-container {
        padding: 50px;
        background: linear-gradient(to bottom, #ffffff 0%, #f8fafc 100%);
      }

      .section-title {
        font-size: 22px;
        color: #0891b2;
        margin: 40px 0 25px 0;
        padding: 18px 24px;
        background: linear-gradient(135deg, #e0f2fe 0%, #d1fae5 100%);
        border-radius: 16px;
        border-left: 5px solid #0891b2;
        font-weight: 700;
        display: flex;
        align-items: center;
        gap: 12px;
        box-shadow: 0 4px 6px rgba(8, 145, 178, 0.1);
      }

      .section-title:first-child {
        margin-top: 0;
      }

      .form-group {
        margin-bottom: 24px;
      }

      .form-row {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 24px;
        margin-bottom: 24px;
      }

      .form-row-3 {
        display: grid;
        grid-template-columns: 1fr 1fr 1fr;
        gap: 20px;
        margin-bottom: 24px;
      }

      label {
        display: block;
        margin-bottom: 10px;
        color: #1e293b;
        font-weight: 600;
        font-size: 14px;
      }

      label .required {
        color: #ef4444;
        font-weight: 700;
      }

      input,
      select,
      textarea {
        width: 100%;
        padding: 14px 18px;
        border: 2px solid #e2e8f0;
        border-radius: 12px;
        font-size: 15px;
        transition: all 0.3s;
        font-family: inherit;
        background: white;
      }

      input:focus,
      select:focus,
      textarea:focus {
        outline: none;
        border-color: #0891b2;
        box-shadow: 0 0 0 4px rgba(8, 145, 178, 0.12);
        background: #f0fdfa;
      }

      input:hover,
      select:hover,
      textarea:hover {
        border-color: #0891b2;
      }

      textarea {
        resize: vertical;
        min-height: 120px;
        line-height: 1.6;
      }

      .radio-group {
        display: flex;
        gap: 24px;
        margin-top: 12px;
      }

      .radio-option {
        display: flex;
        align-items: center;
        gap: 10px;
        padding: 12px 20px;
        border: 2px solid #e2e8f0;
        border-radius: 12px;
        cursor: pointer;
        transition: all 0.3s;
        background: white;
      }

      .radio-option:hover {
        border-color: #0891b2;
        background: #f0fdfa;
      }

      .radio-option input[type="radio"] {
        width: auto;
        margin: 0;
        cursor: pointer;
        accent-color: #0891b2;
      }

      .radio-option input[type="radio"]:checked + label {
        color: #0891b2;
        font-weight: 600;
      }

      .radio-option label {
        margin: 0;
        cursor: pointer;
      }

      .btn-submit {
        background: linear-gradient(135deg, #0891b2 0%, #059669 100%);
        color: white;
        padding: 18px 40px;
        border: none;
        border-radius: 14px;
        font-size: 18px;
        font-weight: 700;
        cursor: pointer;
        width: 100%;
        margin-top: 40px;
        transition: all 0.3s;
        box-shadow: 0 8px 20px rgba(8, 145, 178, 0.3);
        letter-spacing: 0.5px;
      }

      .btn-submit:hover {
        transform: translateY(-3px);
        box-shadow: 0 12px 28px rgba(8, 145, 178, 0.4);
      }

      .btn-submit:active {
        transform: translateY(-1px);
      }

      .btn-submit:disabled {
        opacity: 0.6;
        cursor: not-allowed;
        transform: none;
      }

      .success-message {
        display: none;
        background: linear-gradient(135deg, #d1fae5 0%, #a7f3d0 100%);
        border: 2px solid #059669;
        color: #065f46;
        padding: 20px;
        border-radius: 14px;
        margin-bottom: 30px;
        font-weight: 600;
        box-shadow: 0 4px 10px rgba(5, 150, 105, 0.2);
      }

      .error-message {
        display: none;
        background: linear-gradient(135deg, #fee2e2 0%, #fecaca 100%);
        border: 2px solid #ef4444;
        color: #991b1b;
        padding: 20px;
        border-radius: 14px;
        margin-bottom: 30px;
        font-weight: 600;
        box-shadow: 0 4px 10px rgba(239, 68, 68, 0.2);
      }

      @media (max-width: 768px) {
        .form-row,
        .form-row-3 {
          grid-template-columns: 1fr;
        }

        .form-container {
          padding: 30px 20px;
        }

        .header {
          padding: 40px 20px;
        }

        .header h1 {
          font-size: 26px;
        }

        .header .school-name {
          font-size: 20px;
        }

        .section-title {
          font-size: 18px;
          padding: 14px 18px;
        }
      }

      .info-box {
        background: linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%);
        border-left: 5px solid #3b82f6;
        padding: 20px;
        margin-bottom: 30px;
        border-radius: 12px;
        font-size: 14px;
        color: #1e40af;
        font-weight: 500;
        box-shadow: 0 4px 10px rgba(59, 130, 246, 0.15);
      }

      .info-box strong {
        color: #1e3a8a;
        font-size: 15px;
      }

      .card-section {
        background: white;
        padding: 30px;
        border-radius: 16px;
        margin-bottom: 20px;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        border: 1px solid #e2e8f0;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <div class="header">
        <div class="organization">YAYASAN PENDIDIKAN NURUL ULUM (YPNU)</div>
        <div class="school-name">SEKOLAH MENENGAH PERTAMA MUSLIMIN CILILIN</div>
        <h1>üìö Formulir Pendaftaran Siswa Baru</h1>
        <div class="academic-year">Tahun Ajaran 2026/2027</div>
      </div>

      <div class="form-container">
        <div class="info-box">
          <strong>üìã Petunjuk Pengisian:</strong> Isi semua data yang bertanda
          (<span style="color: #ef4444; font-weight: 700">*</span>) wajib diisi.
          Pastikan data yang Anda masukkan sudah benar dan sesuai dengan dokumen
          resmi.
        </div>

        <div class="success-message" id="successMessage">
          ‚úÖ Pendaftaran berhasil! No. Pendaftaran Anda:
          <strong id="regNumber"></strong>
        </div>

        <div class="error-message" id="errorMessage"></div>

        <form id="registrationForm">
          <!-- Data Siswa -->
          <div class="card-section">
            <div class="section-title">üë§ Data Pribadi Siswa</div>

            <div class="form-row">
              <div class="form-group">
                <label>Nama Lengkap <span class="required">*</span></label>
                <input
                  type="text"
                  id="nama_lengkap"
                  name="nama_lengkap"
                  required
                  placeholder="Masukkan nama lengkap sesuai akta" />
              </div>

              <div class="form-group">
                <label>NISN <span class="required">*</span></label>
                <input
                  type="text"
                  id="nisn"
                  name="nisn"
                  required
                  placeholder="10 digit NISN"
                  maxlength="10" />
              </div>
            </div>

            <div class="form-group">
              <label>Jenis Kelamin <span class="required">*</span></label>
              <div class="radio-group">
                <div class="radio-option">
                  <input
                    type="radio"
                    id="laki"
                    name="jenis_kelamin"
                    value="Laki-laki"
                    required />
                  <label for="laki">üë¶ Laki-laki</label>
                </div>
                <div class="radio-option">
                  <input
                    type="radio"
                    id="perempuan"
                    name="jenis_kelamin"
                    value="Perempuan"
                    required />
                  <label for="perempuan">üëß Perempuan</label>
                </div>
              </div>
            </div>

            <div class="form-row">
              <div class="form-group">
                <label>Tempat Lahir <span class="required">*</span></label>
                <input
                  type="text"
                  id="tempat_lahir"
                  name="tempat_lahir"
                  required
                  placeholder="Contoh: Bandung" />
              </div>

              <div class="form-group">
                <label>Tanggal Lahir <span class="required">*</span></label>
                <input
                  type="date"
                  id="tanggal_lahir"
                  name="tanggal_lahir"
                  required />
              </div>
            </div>

            <div class="form-group">
              <label>Asal Sekolah (SD) <span class="required">*</span></label>
              <input
                type="text"
                id="asal_sekolah"
                name="asal_sekolah"
                required
                placeholder="Contoh: SD Negeri 1 Cililin" />
            </div>

            <div class="form-group">
              <label>Alamat Lengkap <span class="required">*</span></label>
              <textarea
                id="alamat"
                name="alamat"
                required
                placeholder="Masukkan alamat lengkap (Jalan, RT/RW, Desa/Kelurahan, Kecamatan, Kabupaten)"></textarea>
            </div>

            <div class="form-group">
              <label>No. HP/WhatsApp <span class="required">*</span></label>
              <input
                type="tel"
                id="no_hp"
                name="no_hp"
                required
                placeholder="Contoh: 081234567890" />
            </div>
          </div>

          <!-- Data Orang Tua - Ayah -->
          <div class="card-section">
            <div class="section-title">üë®‚Äçüë¶ Data Ayah Kandung</div>

            <div class="form-group">
              <label>Nama Lengkap Ayah <span class="required">*</span></label>
              <input
                type="text"
                id="nama_ayah"
                name="nama_ayah"
                required
                placeholder="Masukkan nama lengkap ayah kandung" />
            </div>

            <div class="form-row">
              <div class="form-group">
                <label>Pekerjaan Ayah <span class="required">*</span></label>
                <input
                  type="text"
                  id="pekerjaan_ayah"
                  name="pekerjaan_ayah"
                  required
                  placeholder="Contoh: Wiraswasta, PNS, Petani" />
              </div>

              <div class="form-group">
                <label
                  >Pendidikan Terakhir Ayah
                  <span class="required">*</span></label
                >
                <select id="pendidikan_ayah" name="pendidikan_ayah" required>
                  <option value="">-- Pilih Pendidikan --</option>
                  <option value="Tidak Sekolah">Tidak Sekolah</option>
                  <option value="SD">SD/Sederajat</option>
                  <option value="SMP">SMP/Sederajat</option>
                  <option value="SMA/SMK">SMA/SMK/Sederajat</option>
                  <option value="D3">Diploma (D1/D2/D3)</option>
                  <option value="S1">Sarjana (S1)</option>
                  <option value="S2">Magister (S2)</option>
                  <option value="S3">Doktor (S3)</option>
                </select>
              </div>
            </div>
          </div>

          <!-- Data Orang Tua - Ibu -->
          <div class="card-section">
            <div class="section-title">üë©‚Äçüë¶ Data Ibu Kandung</div>

            <div class="form-group">
              <label>Nama Lengkap Ibu <span class="required">*</span></label>
              <input
                type="text"
                id="nama_ibu"
                name="nama_ibu"
                required
                placeholder="Masukkan nama lengkap ibu kandung" />
            </div>

            <div class="form-row">
              <div class="form-group">
                <label>Pekerjaan Ibu <span class="required">*</span></label>
                <input
                  type="text"
                  id="pekerjaan_ibu"
                  name="pekerjaan_ibu"
                  required
                  placeholder="Contoh: Ibu Rumah Tangga, Guru, Pedagang" />
              </div>

              <div class="form-group">
                <label
                  >Pendidikan Terakhir Ibu
                  <span class="required">*</span></label
                >
                <select id="pendidikan_ibu" name="pendidikan_ibu" required>
                  <option value="">-- Pilih Pendidikan --</option>
                  <option value="Tidak Sekolah">Tidak Sekolah</option>
                  <option value="SD">SD/Sederajat</option>
                  <option value="SMP">SMP/Sederajat</option>
                  <option value="SMA/SMK">SMA/SMK/Sederajat</option>
                  <option value="D3">Diploma (D1/D2/D3)</option>
                  <option value="S1">Sarjana (S1)</option>
                  <option value="S2">Magister (S2)</option>
                  <option value="S3">Doktor (S3)</option>
                </select>
              </div>
            </div>
          </div>

          <button type="submit" class="btn-submit">üìù Daftar Sekarang</button>
        </form>
      </div>
    </div>

    <script>
      const SUPABASE_URL = "https://enzohhulskcwniosqtnt.supabase.co";
      const SUPABASE_ANON_KEY =
        "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImVuem9oaHVsc2tjd25pb3NxdG50Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTgyNjY4OTgsImV4cCI6MjA3Mzg0Mjg5OH0.32dpWJR55BA_ROrGAd9KxE22X4wVGLRWQ2VGUFG0NKQ";

      document
        .getElementById("registrationForm")
        .addEventListener("submit", async function (e) {
          e.preventDefault();

          const successMsg = document.getElementById("successMessage");
          const errorMsg = document.getElementById("errorMessage");
          const regNumberEl = document.getElementById("regNumber");
          const submitBtn = e.target.querySelector(".btn-submit");

          successMsg.style.display = "none";
          errorMsg.style.display = "none";

          const nisn = document.getElementById("nisn").value;
          if (nisn.length !== 10 || !/^\d+$/.test(nisn)) {
            errorMsg.textContent = "‚ùå NISN harus berisi 10 digit angka!";
            errorMsg.style.display = "block";
            errorMsg.scrollIntoView({ behavior: "smooth", block: "center" });
            return;
          }

          const noHp = document.getElementById("no_hp").value;
          if (!/^08\d{8,11}$/.test(noHp)) {
            errorMsg.textContent =
              "‚ùå Nomor HP tidak valid! Harus dimulai dengan 08 dan 10-13 digit.";
            errorMsg.style.display = "block";
            errorMsg.scrollIntoView({ behavior: "smooth", block: "center" });
            return;
          }

          submitBtn.disabled = true;
          submitBtn.textContent = "‚è≥ Sedang Memproses...";

          const formData = {
            nama_lengkap: document.getElementById("nama_lengkap").value,
            nisn: nisn,
            jenis_kelamin: document.querySelector(
              'input[name="jenis_kelamin"]:checked'
            ).value,
            tempat_lahir: document.getElementById("tempat_lahir").value,
            tanggal_lahir: document.getElementById("tanggal_lahir").value,
            asal_sekolah: document.getElementById("asal_sekolah").value,
            nama_ayah: document.getElementById("nama_ayah").value,
            pekerjaan_ayah: document.getElementById("pekerjaan_ayah").value,
            pendidikan_ayah: document.getElementById("pendidikan_ayah").value,
            nama_ibu: document.getElementById("nama_ibu").value,
            pekerjaan_ibu: document.getElementById("pekerjaan_ibu").value,
            pendidikan_ibu: document.getElementById("pendidikan_ibu").value,
            no_hp: noHp,
            alamat: document.getElementById("alamat").value,
            academic_year: "2026/2027",
            status: "pending",
            is_transferred: false,
            tanggal_daftar: new Date().toISOString().split("T")[0],
            kelas: null,
            transferred_at: null,
            transferred_by: null,
          };

          try {
            const response = await fetch(`${SUPABASE_URL}/rest/v1/siswa_baru`, {
              method: "POST",
              headers: {
                "Content-Type": "application/json",
                apikey: SUPABASE_ANON_KEY,
                Authorization: `Bearer ${SUPABASE_ANON_KEY}`,
                Prefer: "return=representation",
              },
              body: JSON.stringify(formData),
            });

            if (!response.ok) {
              const error = await response.json();
              throw new Error(
                error.message || "Terjadi kesalahan saat menyimpan data"
              );
            }

            const data = await response.json();

            regNumberEl.textContent = data[0].no_pendaftaran;
            successMsg.style.display = "block";
            successMsg.scrollIntoView({ behavior: "smooth", block: "center" });

            this.reset();

            console.log("Data berhasil disimpan:", data);
          } catch (error) {
            console.error("Error:", error);
            errorMsg.textContent = "‚ùå Terjadi kesalahan! " + error.message;
            errorMsg.style.display = "block";
            errorMsg.scrollIntoView({ behavior: "smooth", block: "center" });
          } finally {
            submitBtn.disabled = false;
            submitBtn.textContent = "üìù Daftar Sekarang";
          }
        });

      document.getElementById("nisn").addEventListener("input", function (e) {
        this.value = this.value.replace(/\D/g, "");
      });

      document.getElementById("no_hp").addEventListener("input", function (e) {
        this.value = this.value.replace(/\D/g, "");
      });
    </script>
  </body>
</html>
